# ğŸ¢ Polyhouse Movement Integration - Complete Guide

## ğŸ¯ Overview

Your ERP now has **intelligent polyhouse space management** integrated with batch tracking. When seeds germinate and plants grow, you can easily move them between polyhouse sections with **automatic capacity tracking**.

---

## ğŸŒ± The Complete Plant Journey

```
STEP 1: SEEDS PLANTED
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Production Order Started                 â”‚
â”‚ - Batch Created: BCH00001                â”‚
â”‚ - Stage: Seed                            â”‚
â”‚ - Quantity: 1000 plants                  â”‚
â”‚ - Location: Not Assigned                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
STEP 2: GERMINATION (1-2 weeks)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Move to Germination Zone                â”‚
â”‚                                          â”‚
â”‚ Click â†’ icon on batch                   â”‚
â”‚ Select: Greenhouse A - Germination Zone â”‚
â”‚ Reason: Germination Complete             â”‚
â”‚                                          â”‚
â”‚ AUTO-MAGIC HAPPENS:                      â”‚
â”‚ âœ… Batch moved to GH-A-GERM             â”‚
â”‚ âœ… Occupied: 0 â†’ 1000 plants            â”‚
â”‚ âœ… Available: 10,000 â†’ 9,000            â”‚
â”‚ âœ… Movement logged in history           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
STEP 3: SEEDLING (2-4 weeks)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Move to Seedling Area                   â”‚
â”‚                                          â”‚
â”‚ Select: Greenhouse A - Seedling Area    â”‚
â”‚ Reason: Growth Stage Change              â”‚
â”‚                                          â”‚
â”‚ AUTO-MAGIC:                              â”‚
â”‚ âœ… GH-A-GERM: 1000 â†’ 0 (freed)          â”‚
â”‚ âœ… GH-A-SEED: 0 â†’ 980 (20 died)         â”‚
â”‚ âœ… Capacity auto-adjusted                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
STEP 4: VEGETATIVE (4-8 weeks)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Move to Vegetative Growth                â”‚
â”‚                                          â”‚
â”‚ Select: Shadehouse B - Vegetative Growthâ”‚
â”‚ Reason: Growth Stage Change              â”‚
â”‚                                          â”‚
â”‚ AUTO-MAGIC:                              â”‚
â”‚ âœ… GH-A-SEED freed (capacity restored)   â”‚
â”‚ âœ… SH-B-VEG occupied (capacity reduced)  â”‚
â”‚ âœ… Different environment (shadehouse)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
STEP 5: HARDENING (2 weeks)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Move to Hardening Zone                  â”‚
â”‚                                          â”‚
â”‚ Select: Open Field C - Hardening Zone   â”‚
â”‚ Reason: Ready for Hardening              â”‚
â”‚                                          â”‚
â”‚ AUTO-MAGIC:                              â”‚
â”‚ âœ… Plants adapted to outdoor conditions  â”‚
â”‚ âœ… Capacity tracking continues           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
STEP 6: READY FOR SALE
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Move to Ready Zone                      â”‚
â”‚                                          â”‚
â”‚ Select: Shadehouse B - Ready for Sale   â”‚
â”‚ Reason: Growth Stage Change              â”‚
â”‚                                          â”‚
â”‚ âœ… Plants ready for customers            â”‚
â”‚ âœ… Can convert to Finished Goods         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ï¸ Polyhouse Structure

### Pre-Configured Polyhouses

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              MAIN NURSERY                           â”‚
â”‚         (5000 sq meters total area)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. GREENHOUSE A (500 sq meters - Climate Controlled)
   â”œâ”€ Germination Zone (GH-A-GERM)
   â”‚  - Capacity: 10,000 plants
   â”‚  - Climate Control: âœ… Yes
   â”‚  - Perfect for: Seeds, Early germination
   â”‚
   â””â”€ Seedling Area (GH-A-SEED)
      - Capacity: 5,000 plants
      - Climate Control: âœ… Yes
      - Perfect for: Young seedlings

2. SHADEHOUSE B (300 sq meters - Partial Shade)
   â”œâ”€ Vegetative Growth (SH-B-VEG)
   â”‚  - Capacity: 3,000 plants
   â”‚  - Climate Control: âŒ No
   â”‚  - Perfect for: Active growth phase
   â”‚
   â””â”€ Ready for Sale (SH-B-READY)
      - Capacity: 2,000 plants
      - Climate Control: âŒ No
      - Perfect for: Mature plants waiting for sale

3. OPEN FIELD C (1000 sq meters - Outdoor)
   â””â”€ Hardening Zone (OF-C-HARD)
      - Capacity: 5,000 plants
      - Climate Control: âŒ No
      - Perfect for: Hardening plants before sale
```

---

## ğŸ”„ How to Move Batches

### Step 1: Find Your Batch

Go to: **Batches** page

You'll see all active batches with:
- Batch Code
- Plant Variety
- Current Stage
- Current Quantity
- Current Location (or "Not assigned")
- Cost per Plant
- Total Value

### Step 2: Click Move Button

Click the **green arrow (â†’)** icon next to any batch

### Step 3: Fill Move Form

**Modal appears showing:**

```
Current Batch Info:
- Batch: BCH00001
- Current Location: Greenhouse A - Germination Zone
- Quantity: 980 plants
```

**Fill the form:**

1. **Move to Section** (Required)
   - Dropdown shows all available sections
   - Shows capacity: `(9,000/10,000 available)`
   - Example: Select "Greenhouse A - Seedling Area"

2. **Quantity to Move** (Required)
   - Default: Full batch quantity
   - Can move partial batches
   - Max: Current quantity in batch
   - Example: 980 plants

3. **Movement Reason** (Dropdown)
   - Germination Complete
   - Growth Stage Change â† Most common
   - Space Optimization
   - Disease Control
   - Climate Control Needed
   - Ready for Hardening

4. **Notes** (Optional)
   - Free text field
   - Example: "Plants showing good growth, ready for next stage"

### Step 4: Submit

Click **"Move Batch"** button

**What Happens Automatically:**

1. âœ… **Updates Batch Location**
   ```sql
   batches.polyhouse_section_id = new_section_id
   ```

2. âœ… **Frees Previous Section** (if any)
   ```sql
   old_section.occupied_capacity -= quantity_moved
   old_section.available_capacity += quantity_moved
   ```

3. âœ… **Occupies New Section**
   ```sql
   new_section.occupied_capacity += quantity_moved
   new_section.available_capacity -= quantity_moved
   ```

4. âœ… **Records Movement History**
   ```sql
   INSERT INTO batch_movements (
     batch_id, from_section_id, to_section_id, 
     quantity_moved, movement_date, movement_reason, notes
   )
   ```

---

## ğŸ“Š Database Tables

### batch_movements Table

```sql
CREATE TABLE batch_movements (
    id SERIAL PRIMARY KEY,
    batch_id INTEGER REFERENCES batches(id),
    from_section_id INTEGER REFERENCES polyhouse_sections(id),
    to_section_id INTEGER REFERENCES polyhouse_sections(id),
    quantity_moved INTEGER NOT NULL,
    movement_date DATE NOT NULL,
    movement_reason VARCHAR(100),
    notes TEXT,
    moved_by INTEGER REFERENCES users(id),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

**Example Records:**

| ID | Batch | From Section | To Section | Qty | Date | Reason |
|----|-------|--------------|------------|-----|------|--------|
| 1 | BCH00001 | NULL | GH-A-GERM | 1000 | 2025-12-21 | Initial Placement |
| 2 | BCH00001 | GH-A-GERM | GH-A-SEED | 980 | 2026-01-05 | Germination Complete |
| 3 | BCH00001 | GH-A-SEED | SH-B-VEG | 970 | 2026-02-15 | Growth Stage Change |
| 4 | BCH00001 | SH-B-VEG | OF-C-HARD | 960 | 2026-04-01 | Ready for Hardening |
| 5 | BCH00001 | OF-C-HARD | SH-B-READY | 950 | 2026-04-15 | Ready for Sale |

---

## ğŸ¯ Smart Features

### 1. Capacity Management

**Prevents Overcrowding:**
```
âŒ Cannot move 1000 plants to section with 500 capacity
âœ… System checks: available_capacity >= quantity_moved
```

**Auto-Calculates:**
```javascript
available_capacity = total_capacity - occupied_capacity
```

### 2. Movement Reasons

Pre-defined reasons help with:
- âœ… Tracking why plants were moved
- âœ… Analyzing growth patterns
- âœ… Identifying issues (disease control moves)
- âœ… Reporting and analytics

### 3. Partial Moves

Can split batches across sections:
```
Batch BCH00001 (1000 plants)
â”œâ”€ Move 700 to SH-B-VEG
â””â”€ Keep 300 in GH-A-SEED (slower growing)
```

### 4. Complete Audit Trail

Every movement is logged:
- When was it moved?
- From where to where?
- How many plants?
- Why was it moved?
- Who moved it?

---

## ğŸ“ API Endpoints

```
GET  /api/batches/sections
     â†’ Get all available polyhouse sections with capacity

POST /api/batches/move
     â†’ Move batch to new section
     Body: {
       batch_id: 1,
       to_section_id: 2,
       quantity_moved: 980,
       movement_reason: "Growth Stage Change",
       notes: "Plants ready for next stage"
     }

GET  /api/batches/:batch_id/movements
     â†’ Get movement history for a batch

GET  /api/batches/varieties
     â†’ Get all plant varieties

GET  /api/batches/stages
     â†’ Get all growth stages
```

---

## ğŸ’¡ Use Cases

### Use Case 1: Germinated Seeds

**Scenario:** 1000 rose seeds planted, germinated in 2 weeks

**Steps:**
1. Seeds start with no location (just planted)
2. After 2 weeks, 990 germinated
3. **Click â†’ button** on batch
4. Select: "Greenhouse A - Germination Zone"
5. Reason: "Germination Complete"
6. âœ… Batch moved, capacity updated

### Use Case 2: Slow vs Fast Growers

**Scenario:** Same batch has plants growing at different rates

**Steps:**
1. Batch BCH00001 has 1000 seedlings
2. 700 are ready for vegetative stage
3. 300 need more time
4. **Move 700** to Vegetative section
5. **Keep 300** in Seedling area
6. âœ… Two partial moves, both tracked

### Use Case 3: Disease Control

**Scenario:** Spotted disease in a section

**Steps:**
1. Identify affected section
2. Move healthy batches out
3. Reason: "Disease Control"
4. Notes: "Fungal infection detected, moving healthy plants"
5. âœ… Movement logged for traceability

### Use Case 4: Seasonal Adjustment

**Scenario:** Summer heat, need climate control

**Steps:**
1. Plants in open field suffering
2. Move to climate-controlled greenhouse
3. Reason: "Climate Control Needed"
4. Notes: "Temperature exceeded 40Â°C"
5. âœ… Plants protected, reason documented

---

## ğŸ“Š Capacity Dashboard

### Current Utilization:

```
Greenhouse A - Germination Zone
â”œâ”€ Total: 10,000
â”œâ”€ Occupied: 3,500
â”œâ”€ Available: 6,500
â””â”€ Utilization: 35%

Greenhouse A - Seedling Area
â”œâ”€ Total: 5,000
â”œâ”€ Occupied: 4,200
â”œâ”€ Available: 800
â””â”€ Utilization: 84% âš ï¸ High

Shadehouse B - Vegetative Growth
â”œâ”€ Total: 3,000
â”œâ”€ Occupied: 1,500
â”œâ”€ Available: 1,500
â””â”€ Utilization: 50%

Shadehouse B - Ready for Sale
â”œâ”€ Total: 2,000
â”œâ”€ Occupied: 950
â”œâ”€ Available: 1,050
â””â”€ Utilization: 48%

Open Field C - Hardening Zone
â”œâ”€ Total: 5,000
â”œâ”€ Occupied: 800
â”œâ”€ Available: 4,200
â””â”€ Utilization: 16%
```

---

## âœ… Benefits

### 1. Space Optimization
- Know exactly where plants are
- Prevent overcrowding
- Maximize polyhouse utilization

### 2. Growth Tracking
- See plant journey from seed to sale
- Identify bottlenecks in growth stages
- Optimize space allocation

### 3. Environmental Control
- Move plants needing climate control
- Separate by growth requirements
- Hardening zone for outdoor preparation

### 4. Traceability
- Complete movement history
- Audit trail for compliance
- Identify patterns and issues

### 5. Capacity Planning
- Know available space before planting
- Plan production orders based on capacity
- Avoid overcrowding issues

---

## ğŸš€ Quick Start

### For New Batches:

1. **Create Production Order** â†’ `/production`
2. **Start Production** â†’ Creates batch (no location yet)
3. **Seeds Germinate** (1-2 weeks)
4. **Move to Germination Zone** â†’ Click â†’ icon
5. **Track Growth** â†’ Move between sections as plants grow
6. **Ready for Sale** â†’ Move to Ready section
7. **Convert to Finished Goods** â†’ `/production` FG tab

### For Existing Batches:

1. Go to **Batches** page
2. Find batch without location (shows "-")
3. Click **â†’ icon**
4. Select appropriate section
5. Reason: "Initial Placement"
6. âœ… Batch now has location!

---

## ğŸ¯ Best Practices

### 1. Move Promptly
- Move batches when growth stage changes
- Don't let plants outgrow their section
- Keep seedlings separate from mature plants

### 2. Use Correct Reasons
- Helps with analytics
- Makes sense for future reference
- Required for compliance/audits

### 3. Add Notes
- Document observations
- Note any issues
- Helpful for team communication

### 4. Monitor Capacity
- Check utilization regularly
- Plan moves in advance
- Don't wait until section is full

### 5. Track Partial Moves
- Separate slow/fast growers
- Better space utilization
- More accurate cost tracking

---

## ğŸ“ˆ Reporting

### Movement Reports You Can Generate:

1. **Batch Movement History**
   - Where has BCH00001 been?
   - How long in each section?
   - Why was it moved?

2. **Section Utilization**
   - Which sections are full?
   - Which have spare capacity?
   - Peak utilization times?

3. **Movement Patterns**
   - Average time in each section?
   - Most common movement reasons?
   - Identify bottlenecks?

4. **Capacity Forecast**
   - Based on current production orders
   - When will sections be full?
   - Need for expansion?

---

## ğŸŠ Summary

**Your Nursery Now Has:**

âœ… **5 Pre-configured Polyhouse Sections**  
âœ… **Automatic Capacity Tracking**  
âœ… **One-Click Batch Movement**  
âœ… **Complete Movement History**  
âœ… **Intelligent Space Management**  
âœ… **Growth Stage Integration**  

**The system intelligently manages:**
- Where plants are located
- How much space is available
- When to move plants
- Why plants were moved
- Complete audit trail

**From seed to sale, every plant's journey is tracked! ğŸŒ±â†’ğŸ¢â†’ğŸŒ¹**

---

## ğŸ”— Navigation

- **View Batches:** http://localhost:3000/batches
- **Move Batch:** Click â†’ icon on any batch
- **View Polyhouses:** http://localhost:3000/polyhouses
- **Track Capacity:** Polyhouses page shows utilization

**Your plants now have a home! ğŸ ğŸŒ±**
